<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Mitra - RECHAIN OIL</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="icon" href="assets/images/logo.png" type="image/png">
    <style>
        body { 
            background: #f8f9fa; 
            overflow-x: hidden;
        }
        
        /* --- SIDEBAR STYLE --- */
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(180deg, #0d6efd 0%, #0dcaf0 100%);
            color: white;
            position: fixed;
            top: 0;
            left: 0;
            width: 260px;
            padding-top: 20px;
            z-index: 1050;
            transition: all 0.3s;
            box-shadow: 4px 0 10px rgba(0,0,0,0.1);
        }
        
        .sidebar .nav-link {
            color: rgba(255,255,255,0.9);
            padding: 12px 20px;
            border-radius: 8px;
            margin: 4px 15px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }
        
        .sidebar .nav-link:hover,
        .sidebar .nav-link.active {
            background: rgba(255,255,255,0.2);
            color: white;
            transform: translateX(5px);
        }

        /* --- MAIN CONTENT STYLE --- */
        .main-content {
            margin-left: 260px;
            padding: 30px;
            width: calc(100% - 260px);
            min-height: 100vh;
            transition: all 0.3s;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s;
            border: 1px solid rgba(0,0,0,0.05);
            height: 100%;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .pending-badge {
            background: #ffc107;
            color: #000;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-left: auto;
        }

        @media (max-width: 992px) {
            .sidebar { left: -260px; }
            .sidebar.active { left: 0; }
            .main-content { margin-left: 0; width: 100%; padding: 20px; }
        }
    </style>
</head>
<body>
    
    <div class="d-lg-none p-3 bg-white shadow-sm sticky-top d-flex justify-content-between align-items-center">
        <span class="fw-bold text-primary">MITRA PANEL</span>
        <button class="btn btn-outline-primary" onclick="document.querySelector('.sidebar').classList.toggle('active')">
            <i class="bi bi-list"></i> Menu
        </button>
    </div>

    <div class="sidebar">
        <div class="text-center mb-4 px-3">
            <img src="assets/images/logo-rechain-oil.png" alt="RECHAIN OIL" class="mb-3 bg-white rounded-circle p-1" style="height: 50px; width: 50px; object-fit: contain;">
            <h6 class="mb-0 fw-bold" id="mitraNameSidebar">Mitra Demo</h6>
            <small class="text-white-50" style="font-size: 0.8rem;">Verifikasi Partner</small>
        </div>
        
        <nav class="nav flex-column">
            <a class="nav-link active" href="#" onclick="showSection('dashboard')">
                <i class="bi bi-speedometer2 me-3"></i>Dashboard
            </a>
            <a class="nav-link" href="#" onclick="showSection('verifikasi')">
                <i class="bi bi-check-circle me-3"></i>Verifikasi
                <span class="pending-badge" id="sidebarPendingCount">0</span>
            </a>
            <a class="nav-link" href="#" onclick="showSection('riwayat')">
                <i class="bi bi-clock-history me-3"></i>Riwayat
            </a>
            <a class="nav-link" href="#" onclick="showSection('statistik')">
                <i class="bi bi-bar-chart-line me-3"></i>Statistik
            </a>
            <a class="nav-link" href="#" onclick="showSection('profil')">
                <i class="bi bi-shop-window me-3"></i>Profil Usaha
            </a>
        </nav>
        
        <div class="mt-auto p-3 position-absolute bottom-0 w-100">
            <div class="border-top border-white border-opacity-25 pt-3">
                <a href="#" onclick="logout()" class="nav-link text-white justify-content-center bg-white bg-opacity-10 rounded">
                    <i class="bi bi-box-arrow-right me-2"></i>Logout
                </a>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="container-fluid p-0">

            <div id="dashboardSection">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h2 class="fw-bold mb-0 text-dark">Dashboard Mitra</h2>
                        <p class="text-muted mb-0">Ringkasan aktivitas pengumpulan minyak</p>
                    </div>
                    <button class="btn btn-primary shadow-sm" onclick="showSection('verifikasi')">
                        <i class="bi bi-play-circle me-2"></i>Mulai Verifikasi
                    </button>
                </div>

                <div class="row g-3 mb-4">
                    <div class="col-12 col-sm-6 col-xl-3">
                        <div class="stat-card">
                            <div class="d-flex align-items-center">
                                <div class="bg-warning bg-opacity-10 p-3 rounded-circle"><i class="bi bi-hourglass-split fs-3 text-warning"></i></div>
                                <div class="ms-3"><h6 class="text-muted mb-1 small text-uppercase">Menunggu</h6><h3 class="mb-0 fw-bold" id="statPending">0</h3></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-xl-3">
                        <div class="stat-card">
                            <div class="d-flex align-items-center">
                                <div class="bg-success bg-opacity-10 p-3 rounded-circle"><i class="bi bi-check-lg fs-3 text-success"></i></div>
                                <div class="ms-3"><h6 class="text-muted mb-1 small text-uppercase">Verified</h6><h3 class="mb-0 fw-bold" id="statVerified">0</h3></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-xl-3">
                        <div class="stat-card">
                            <div class="d-flex align-items-center">
                                <div class="bg-info bg-opacity-10 p-3 rounded-circle"><i class="bi bi-droplet-fill fs-3 text-info"></i></div>
                                <div class="ms-3"><h6 class="text-muted mb-1 small text-uppercase">Volume</h6><h3 class="mb-0 fw-bold" id="statVolume">0 L</h3></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-xl-3">
                        <div class="stat-card">
                            <div class="d-flex align-items-center">
                                <div class="bg-primary bg-opacity-10 p-3 rounded-circle"><i class="bi bi-people-fill fs-3 text-primary"></i></div>
                                <div class="ms-3"><h6 class="text-muted mb-1 small text-uppercase">User Unik</h6><h3 class="mb-0 fw-bold" id="statUsers">0</h3></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-header bg-white py-3 border-bottom-0"><h6 class="mb-0 fw-bold">Tren Mingguan</h6></div>
                            <div class="card-body"><canvas id="mitraWeeklyChart" style="max-height: 300px;"></canvas></div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-header bg-white py-3 border-bottom-0"><h6 class="mb-0 fw-bold">Aktivitas Terbaru</h6></div>
                            <div class="card-body p-0"><div id="recentActivityList" class="list-group list-group-flush"></div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="verifikasiSection" style="display: none;">
                <h3 class="fw-bold mb-4">Verifikasi Setoran</h3>
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="bg-light"><tr><th class="ps-4">Tanggal</th><th>User Info</th><th>Volume</th><th>Lokasi</th><th>Status</th><th class="text-end pe-4">Aksi</th></tr></thead>
                                <tbody id="pendingTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="riwayatSection" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="fw-bold mb-0">Riwayat Verifikasi</h3>
                    <button class="btn btn-outline-success btn-sm"><i class="bi bi-file-excel me-2"></i>Export</button>
                </div>
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="bg-light"><tr><th class="ps-4">ID</th><th>Tanggal</th><th>User</th><th>Volume</th><th>Token</th><th>Hash</th></tr></thead>
                                <tbody id="historyTable"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="statistikSection" style="display: none;">
                <h3 class="fw-bold mb-4">Analitik Kinerja</h3>
                <div class="row g-4 mb-4">
                    <div class="col-md-4"><div class="card border-0 shadow-sm text-center p-4 h-100"><i class="bi bi-graph-up-arrow fs-2 text-primary mb-2"></i><h4 class="fw-bold" id="avgVolumeStat">0 L</h4><p class="text-muted mb-0 small">Rata-rata Volume</p></div></div>
                    <div class="col-md-4"><div class="card border-0 shadow-sm text-center p-4 h-100"><i class="bi bi-currency-exchange fs-2 text-success mb-2"></i><h4 class="fw-bold" id="totalRevenueStat">Rp 0</h4><p class="text-muted mb-0 small">Nilai Token (Est)</p></div></div>
                    <div class="col-md-4"><div class="card border-0 shadow-sm text-center p-4 h-100"><i class="bi bi-star-fill fs-2 text-warning mb-2"></i><h4 class="fw-bold">4.8/5.0</h4><p class="text-muted mb-0 small">Rating User</p></div></div>
                </div>
                <div class="row g-4">
                    <div class="col-lg-6"><div class="card border-0 shadow-sm h-100"><div class="card-header bg-white py-3"><h6 class="mb-0 fw-bold">Volume Bulanan</h6></div><div class="card-body"><canvas id="monthlyChart"></canvas></div></div></div>
                    <div class="col-lg-6"><div class="card border-0 shadow-sm h-100"><div class="card-header bg-white py-3"><h6 class="mb-0 fw-bold">Top Kontributor</h6></div><div class="card-body p-0"><ul class="list-group list-group-flush" id="topUsersList"></ul></div></div></div>
                </div>
            </div>

            <div id="profilSection" style="display: none;">
                <h3 class="fw-bold mb-4">Profil Usaha</h3>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-white py-3 border-bottom-0">
                                <h5 class="mb-0 fw-bold"><i class="bi bi-building-gear me-2"></i>Informasi Mitra</h5>
                            </div>
                            <div class="card-body p-4">
                                <form id="mitraProfileForm">
                                    <div class="text-center mb-4">
                                        <div class="bg-primary bg-opacity-10 rounded-circle d-inline-flex align-items-center justify-content-center" style="width: 100px; height: 100px;">
                                            <i class="bi bi-shop-window display-4 text-primary"></i>
                                        </div>
                                    </div>

                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold">Nama Usaha</label>
                                            <input type="text" class="form-control" id="profileCompany" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold">Nama PIC</label>
                                            <input type="text" class="form-control" id="profilePIC" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold">Email Bisnis</label>
                                            <input type="email" class="form-control bg-light" id="profileEmail" readonly>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold">No. WhatsApp</label>
                                            <input type="tel" class="form-control" id="profilePhone" required>
                                        </div>
                                        <div class="col-12">
                                            <label class="form-label fw-semibold">Alamat Operasional</label>
                                            <textarea class="form-control" id="profileAddress" rows="3" required></textarea>
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold">Target/Kapasitas (Liter)</label>
                                            <input type="number" class="form-control" id="profileCapacity">
                                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label fw-semibold">Status Mitra</label>
                                            <input type="text" class="form-control bg-success bg-opacity-10 text-success fw-bold" value="Active Partner" readonly>
                                        </div>
                                    </div>

                                    <div class="d-grid gap-2 mt-4">
                                        <button type="submit" class="btn btn-primary">
                                            <i class="bi bi-save me-2"></i>Simpan Perubahan
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div> </div> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // 1. CEK OTENTIKASI
        if (!localStorage.getItem('userRole') || localStorage.getItem('userRole') !== 'mitra') {
            window.location.href = 'login.html';
        }

        // Set nama awal di sidebar
        const sessionName = localStorage.getItem('userName') || 'Mitra Demo';
        document.getElementById('mitraNameSidebar').textContent = sessionName;

        // ==========================================
        // 2. DATA SIMULASI & PROFIL
        // ==========================================
        function initializeDemoData() {
            // Data Pending (Masuk ke tabel verifikasi)
            const demoPending = [
                { id: 'TX-101', date: new Date().toISOString(), user: 'Budi Santoso', volume: 15.0, location: 'Jl. Melati No. 5, Tebet', status: 'Pending' },
                { id: 'TX-102', date: new Date(Date.now() - 3600000).toISOString(), user: 'Siti Aminah', volume: 8.5, location: 'Komp. Polri, Ragunan', status: 'Pending' },
                { id: 'TX-103', date: new Date(Date.now() - 7200000).toISOString(), user: 'Warung Bu Dewi', volume: 25.0, location: 'Ps. Minggu Blok A', status: 'Pending' }
            ];

            // Data Verified (Masuk ke riwayat)
            const demoVerified = [
                { id: 'TX-099', verifiedDate: '2025-12-02T10:00:00', user: 'Ahmad Rizky', volume: 50.0, tokens: 500, hash: '0xabc...def' },
                { id: 'TX-098', verifiedDate: '2025-12-01T14:30:00', user: 'Resto Padang Jaya', volume: 200.0, tokens: 2000, hash: '0x123...456' },
                { id: 'TX-097', verifiedDate: '2025-11-28T09:15:00', user: 'Budi Santoso', volume: 10.0, tokens: 100, hash: '0x789...012' },
                { id: 'TX-096', verifiedDate: '2025-11-25T11:00:00', user: 'Siti Aminah', volume: 5.0, tokens: 50, hash: '0xaaa...bbb' }
            ];

            window.pendingData = demoPending;
            window.verifiedData = demoVerified;
        }

        // --- FUNGSI PROFIL USAHA ---
        function loadMitraProfile() {
            const currentEmail = localStorage.getItem('userEmail');
            const partners = JSON.parse(localStorage.getItem('partnerRegistrations') || '[]');
            
            // Cari data mitra yang login
            const myProfile = partners.find(p => p.email === currentEmail);

            if (myProfile) {
                // Isi form dengan data asli
                document.getElementById('profileCompany').value = myProfile.companyName || '';
                document.getElementById('profilePIC').value = myProfile.picName || '';
                document.getElementById('profileEmail').value = myProfile.email || currentEmail;
                document.getElementById('profilePhone').value = myProfile.whatsappNumber || '';
                document.getElementById('profileAddress').value = myProfile.address || '';
                document.getElementById('profileCapacity').value = myProfile.oilAmount || '';
            } else {
                // Jika login pakai akun demo hardcoded, isi dummy
                document.getElementById('profileCompany').value = localStorage.getItem('userName') || 'Mitra Demo Sejahtera';
                document.getElementById('profilePIC').value = 'Budi Santoso';
                document.getElementById('profileEmail').value = currentEmail || 'mitra@demo.com';
                document.getElementById('profilePhone').value = '081234567890';
                document.getElementById('profileAddress').value = 'Jl. Jenderal Sudirman No. 45, Jakarta Pusat';
                document.getElementById('profileCapacity').value = '1000';
            }
        }

        document.getElementById('mitraProfileForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            const currentEmail = localStorage.getItem('userEmail');
            let partners = JSON.parse(localStorage.getItem('partnerRegistrations') || '[]');
            const index = partners.findIndex(p => p.email === currentEmail);

            const updatedData = {
                companyName: document.getElementById('profileCompany').value,
                picName: document.getElementById('profilePIC').value,
                email: document.getElementById('profileEmail').value,
                whatsappNumber: document.getElementById('profilePhone').value,
                address: document.getElementById('profileAddress').value,
                oilAmount: document.getElementById('profileCapacity').value,
                type: 'partner'
            };

            if (index !== -1) {
                // Update data yang ada
                partners[index] = { ...partners[index], ...updatedData };
            } else {
                // Buat data baru jika akun demo
                partners.push(updatedData);
            }

            // Simpan ke storage
            localStorage.setItem('partnerRegistrations', JSON.stringify(partners));
            localStorage.setItem('userName', updatedData.companyName); // Update nama sesi
            
            // Update UI Sidebar
            document.getElementById('mitraNameSidebar').textContent = updatedData.companyName;
            
            alert('Profil usaha berhasil diperbarui!');
        });

        // ==========================================
        // 3. FUNGSI RENDER DASHBOARD
        // ==========================================
        function updateDashboardStats() {
            const totalPending = window.pendingData.length;
            const totalVerified = window.verifiedData.length;
            const totalVolume = window.verifiedData.reduce((acc, curr) => acc + curr.volume, 0);
            const uniqueUsers = new Set([...window.pendingData, ...window.verifiedData].map(item => item.user)).size;

            document.getElementById('statPending').textContent = totalPending;
            document.getElementById('sidebarPendingCount').textContent = totalPending;
            document.getElementById('statVerified').textContent = totalVerified;
            document.getElementById('statVolume').textContent = totalVolume.toFixed(1) + ' L';
            document.getElementById('statUsers').textContent = uniqueUsers;

            const recentList = document.getElementById('recentActivityList');
            let activityHTML = '';
            
            const activities = [
                ...window.pendingData.map(d => ({...d, type: 'New Request', time: d.date})),
                ...window.verifiedData.map(d => ({...d, type: 'Verified', time: d.verifiedDate}))
            ].sort((a, b) => new Date(b.time) - new Date(a.time)).slice(0, 5);

            activities.forEach(act => {
                const icon = act.type === 'Verified' ? 'bi-check-circle-fill text-success' : 'bi-hourglass-split text-warning';
                const msg = act.type === 'Verified' ? `Verifikasi ${act.volume}L selesai` : `Permintaan baru ${act.volume}L`;
                
                activityHTML += `
                    <div class="list-group-item d-flex align-items-center py-3 border-0 border-bottom">
                        <i class="bi ${icon} fs-4 me-3"></i>
                        <div class="flex-grow-1">
                            <h6 class="mb-0 fw-bold">${act.user}</h6>
                            <small class="text-muted">${msg}</small>
                        </div>
                        <small class="text-muted">${new Date(act.time).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</small>
                    </div>
                `;
            });
            recentList.innerHTML = activityHTML;
        }

        // ==========================================
        // 4. FUNGSI RENDER TABEL & STATS
        // ==========================================
        function loadPendingTable() {
            const tbody = document.getElementById('pendingTable');
            if(window.pendingData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted py-5">Tidak ada permintaan baru</td></tr>';
                return;
            }
            let html = '';
            window.pendingData.forEach((item, index) => {
                html += `<tr><td class="ps-4">${new Date(item.date).toLocaleDateString('id-ID')}</td><td><div class="fw-bold">${item.user}</div></td><td><span class="fw-bold text-primary">${item.volume} L</span></td><td>${item.location}</td><td><span class="badge bg-warning text-dark">Menunggu</span></td><td class="text-end pe-4"><button class="btn btn-success btn-sm me-1" onclick="verifyAction(${index})"><i class="bi bi-check-lg"></i> Terima</button><button class="btn btn-outline-danger btn-sm" onclick="rejectAction(${index})"><i class="bi bi-x-lg"></i></button></td></tr>`;
            });
            tbody.innerHTML = html;
        }

        function loadHistoryTable() {
            const tbody = document.getElementById('historyTable');
            let html = '';
            window.verifiedData.forEach((item) => {
                html += `<tr><td class="ps-4"><small class="text-muted font-monospace">${item.id}</small></td><td>${new Date(item.verifiedDate).toLocaleString('id-ID')}</td><td>${item.user}</td><td>${item.volume} L</td><td><span class="badge bg-success bg-opacity-10 text-success">+${item.tokens} RCT</span></td><td><small class="text-muted font-monospace">${item.hash}</small></td></tr>`;
            });
            tbody.innerHTML = html;
        }

        function verifyAction(index) {
            if(confirm('Konfirmasi verifikasi?')) {
                const item = window.pendingData[index];
                const verifiedItem = { id: item.id, verifiedDate: new Date().toISOString(), user: item.user, volume: item.volume, tokens: Math.floor(item.volume * 10), hash: '0x' + Math.random().toString(16).substr(2, 8) };
                window.verifiedData.unshift(verifiedItem);
                window.pendingData.splice(index, 1);
                updateDashboardStats(); loadPendingTable(); loadHistoryTable();
            }
        }

        function rejectAction(index) {
            if(confirm('Tolak setoran?')) {
                window.pendingData.splice(index, 1);
                updateDashboardStats(); loadPendingTable();
            }
        }

        function loadTopUsers() {
            const list = document.getElementById('topUsersList');
            if(!list) return;
            const users = [ { name: 'Resto Padang Jaya', vol: 850 }, { name: 'Warung Bu Dewi', vol: 420 }, { name: 'Budi Santoso', vol: 150 }, { name: 'Siti Aminah', vol: 95 } ];
            list.innerHTML = users.map((u, i) => `<li class="list-group-item d-flex justify-content-between align-items-center py-3"><div><span class="badge bg-light text-dark me-2">#${i+1}</span>${u.name}</div><span class="fw-bold text-primary">${u.vol} L</span></li>`).join('');
            
            // Update stats
            if(document.getElementById('avgVolumeStat')) document.getElementById('avgVolumeStat').textContent = '24.5 L';
            if(document.getElementById('totalRevenueStat')) document.getElementById('totalRevenueStat').textContent = 'Rp 4.250.000';
        }

        function initMitraCharts() {
            const ctx1 = document.getElementById('mitraWeeklyChart');
            if (ctx1) new Chart(ctx1.getContext('2d'), { type: 'line', data: { labels: ['Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab', 'Min'], datasets: [{ label: 'Volume (Liter)', data: [45, 52, 38, 65, 48, 70, 60], borderColor: '#0d6efd', backgroundColor: 'rgba(13, 110, 253, 0.1)', fill: true, tension: 0.4 }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } } });
            
            const ctx2 = document.getElementById('monthlyChart');
            if (ctx2) new Chart(ctx2.getContext('2d'), { type: 'bar', data: { labels: ['Agu', 'Sep', 'Okt', 'Nov', 'Des'], datasets: [{ label: 'Volume (Liter)', data: [1200, 1500, 1800, 2200, 2600], backgroundColor: '#0dcaf0', borderRadius: 5 }] }, options: { responsive: true, maintainAspectRatio: false } });
        }

        // ==========================================
        // 5. NAVIGATION
        // ==========================================
        function showSection(section) {
            const sections = ['dashboard', 'verifikasi', 'riwayat', 'statistik', 'profil'];
            sections.forEach(s => {
                const el = document.getElementById(s + 'Section');
                if(el) el.style.display = 'none';
            });

            const target = document.getElementById(section + 'Section');
            if(target) target.style.display = 'block';

            if(section === 'statistik') loadTopUsers();
            if(section === 'verifikasi') loadPendingTable();
            if(section === 'riwayat') loadHistoryTable();
            if(section === 'profil') loadMitraProfile();

            document.querySelectorAll('.sidebar .nav-link').forEach(link => link.classList.remove('active'));
            if(event && event.target) {
                if(event.target.classList.contains('nav-link')) event.target.classList.add('active');
                else if(event.target.closest('.nav-link')) event.target.closest('.nav-link').classList.add('active');
            }
        }

        function logout() {
            localStorage.removeItem('userRole');
            window.location.href = 'login.html';
        }

        // Start
        initializeDemoData();
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboardStats();
            initMitraCharts();
        });
    </script>
</body>
</html>